# 工作自動化控制中心 (Dashboard) - UI 設計規格說明書

本文件旨在提供給 UI/UX 設計師或前端開發人員，作為開發「工作自動化控制中心」的規格依據。本工具負責整合「Excel 資料處理」與「網頁自動截圖」兩大核心功能。

---

## 1. 專案目標
建立一個直覺且現代化的桌面端儀表板（Dashboard），讓非技術人員能輕鬆完成從 Excel 資料轉換到自動化截圖的完整工作流。

## 2. 核心功能分區

介面應分為三大區塊：
1.  **資料預處理 (Excel Preprocessing)**
2.  **自動化控制 (Automation Control)**
3.  **檔案與日誌管理 (File & Log Management)**

---

## 3. 詳細功能與按鍵規格

### A. 資料預處理區塊 (Excel to TXT)
*目的是將原始報告 Excel 轉為系統可讀取的 TXT 群組檔。*

*   **功能描述**：選取 Excel 檔案 -> 執行後端邏輯 (合併相同檢舉人) -> 產出多個 TXT。
*   **介面元件**：
    *   **檔案路徑顯示框**：顯示目前選取的 Excel 路徑（唯讀）。
    *   **[選擇並啟動轉換] 按鍵**：點擊後彈出檔案瀏覽器，選取完畢後直接執行轉換程式。
    *   **狀態提示**：顯示「尚未選取」、「轉換中...」或「完成（產出 X 個檔案）」。
*   **按鍵邏輯**：
    1. 開啟檔案視窗限制選取 `.xlsx`。
    2. 呼叫 `excel_轉換/convert_excel.py` 腳本。

### B. 自動化截圖區塊 (Screenshot Task)
*目的是設定截圖參數並執行任務。*

*   **功能描述**：配置截圖細節並啟動 Playwright 自動化流程。
*   **核心配置按鍵**：
    *   **[設定參數] 按鍵**：點擊後彈出二級設定視窗（或側邊欄）。
        *   *配置細節含*：每頁等待秒數（範圍）、截圖倒數秒數、是否開啟 Word 輸出、關鍵字過濾（驗證碼/不存在/BSMI）、截圖範圍（全螢幕/視窗）、裁切像素值。
    *   **[啟動自動截圖] 按鍵**：主要執行鍵。啟動後瀏覽器會自動工作。
*   **運行監測**：
    *   **進度條 (Progress Bar)**：根據總網址數顯示目前進度（例如：15/100）。
    *   **即時狀態列**：顯示目前動作（例如：「正在載入網址：P12345...」、「等待倒數 5s」）。
    *   **[停止/暫停] 按鍵**：任務啟動後應切換為此按鍵，提供緊急中斷能力。

### C. 檔案與工具列 (Quick Access)
*   **[開啟產出目錄]**：路徑指向 `excel_轉換/output/日期資料夾`。
*   **[開啟截圖結果]**：路徑指向 `截圖腳本/screenshots_urls`。
*   **[檢視日誌]**：用記事本開啟最新的 `logs/*.log`。
*   **[清除舊紀錄]**：清除 `done_urls.json` 以便重新截圖相同的網址。

---

## 4. 介面交互設計 (User Flow)

1.  **使用者操作流**：
    *   Step 1: 點擊「選擇並啟動轉換」，完成資料前置作業。
    *   Step 2: 點擊「設定參數」確認今天的工作模式（例如：是否要裁切頁首）。
    *   Step 3: 點擊「啟動自動截圖」，雙手放開觀察進度條。
    *   Step 4: 完成後點擊「開啟截圖結果」進行查核。

2.  **回饋機制**：
    *   任何長時任務（轉換或截圖）必須有 Loading 動態效果。
    *   任務失敗時需彈出 Error Dialog 並提示查看日誌。

---

## 5. 視覺風格建議 (Design Guideline)

*   **配色**：深色模式 (Dark Mode) 或 精鍊藍白風格。
*   **字體**：繁體中文推薦使用 `Microsoft JhengHei` 或 `Inter`。
*   **質感**：
    *   使用卡片式佈局 (Card Layout) 區分功能。
    *   按鍵需具備 Hover 與 Active 狀態變化。
    *   狀態文字顏色建議：完成 (綠色)、警告 (黃色)、錯誤 (紅色)。

---

## 6. 技術環境摘要 (供開發參考)
*   **開發語言**：Python 3.12+
*   **核心套件**：tkinter (GUI), openpyxl (Excel), playwright (自動化), pillow (影像處理).
*   **系統環境**：Windows 10/11簡稱。
*   **顯示需求**：支援 High DPI 編程 (避免 UI 模糊)。
