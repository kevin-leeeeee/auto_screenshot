# AutoFlow Control Center 更新日誌
+
+## [v3.3.2] - 2026-01-16
+### 🔄 強制依賴更新
+- **強制更新修復檔案**: 發布此版本以觸發完整的檔案同步，確保先前版本漏抓的 `utils_image.py` (含崩潰修復) 能被正確下載並套用。
+- **版本升級**: 統一版本號至 v3.3.2。

+
+## [v3.3.1] - 2026-01-16
+### 🚑 緊急修復 (Hotfix)
+- **修補更新不完整問題**: 修正了「僅更新腳本」功能未包含關鍵的底層影像處理庫 (`utils_image.py`)，導致更新後仍使用舊版代碼而閃退的問題。
+- **停用 PyAutoGUI FailSafe**: 強制停用滑鼠游標防呆機制，避免滑鼠移動到螢幕角落時觸發異常中斷。
+- **版本升級**: 統一版本號至 v3.3.1。

+
+## [v3.3.0] - 2026-01-16
+### 🐛 臭蟲修復與穩定性提升
+- **修補文字分類閃退**: 修正了在啟用文字分類（OCR）功能時，若關鍵字優先順序未正確初始化可能導致的程式無預警關閉問題。
+- **版本升級**: 統一版本號至 v3.3.0。


## [v3.2.1] - 2026-01-16
### ✨ 介面微調與文件修正
- **修正自動截圖說明**: 將自動截圖模組的支援說明從「支援試算表與文字檔」修正為正確的「支援純文字檔 (.txt)」，避免引發誤解。
- **流程優化**: 統一所有核心元件、文件與打包腳本的版本號至 v3.2.1。

## [v3.2.0] - 2026-01-16
### ✨ 介面優化與版本邏輯修正
- **更新通知位置調整**: 將「發現新版本」的提示框移至側邊欄「檢查更新」按鈕上方，視覺更直觀且不遮擋主畫面。
- **智慧版本判定**: 修正了當本機版本高於 GitHub 最新發布版本時仍提示更新的問題（改為僅在有更高版本時提示）。
- **流程優化**: 統一所有核心元件與文件版本號至 v3.2.0。

## [v3.1.0] - 2026-01-16
### ✨ 核心修復與命令行支援
- **修復更新按鈕**: 解決了 UI 中「檢查更新」按鈕點擊無反應的問題。
- **支援命令行更新**: 現在可以透過 `python run.py --update` 直接進行腳本更新，無需開啟介面。
- **穩定性提升**: 
    - 修復了 `update_scripts` 中未定義變數導致介面包 (ui.zip) 更新失敗的 Bug。
    - 解決了多個 TypeScript 類型定義錯誤 (Lint Errors)。
- **版號同步**: 統一所有元件、文件與核心程式碼的版本號至 v3.1.0。

## [v3.0.0] - 2026-01-16
### 🏆 插拔式架構里程碑 (Major Architecture Milestone)
- **架構升級**: 本版本正式確立「平台與邏輯分離」架構。未來所有 UI 與腳本更新僅需替換 `_internal` 內的子目錄，無需重新下載 300MB 的主程式或重新打包 EXE。
- **穩定性修復 (重大)**: 
    - 解決 EXE 打包後的 `ModuleNotFoundError` (PIL, docx, webview 等)。
    - 修復檔案選擇對話框缺失 `tkinter.filedialog` 的報錯問題。
- **解決編碼崩潰**: 徹底移除程式輸出中的 Emoji，防止在 Windows `cp950` 環境下產生 `UnicodeEncodeError` 閃退。
- **路徑智能解析**: 核心邏輯現在能自動適應 PyInstaller 的 `_internal` 資源目錄結構。
- **UI 修正**: 解決啟動後出現的 "Not Found" 資源定位錯誤。

### 🛠️ 功能優化
- **截圖歸檔與防嵌套**: 自動建立獨立子資料夾歸檔結果，並修正了目錄重複嵌套的 Bug。
- **介面體驗**: 截圖結果列表過濾為「僅顯示 Word 文件」，並修復了輪詢導致的介面閃爍問題。

## [v2.4.0] - 2026-01-15
### ✨ 插拔式介面架構 (Pluggable UI)
- **架構重大升級**: 介面層現在完全從主程式中解耦，放置於外部 `ui` 目錄，大幅提升未來更新效率。
- **極速介面更新**: 未來修正 UI 色差、按鈕樣式等視覺問題，僅需下載幾百 KB 的補丁透過「核心更新」即可完成。
- **介面衝突修復**: 優化更新提示邏輯，當開啟詳細更新說明時，自動隱藏左下角浮動通知，解決視覺覆蓋問題。

## [v2.3.1] - 2026-01-15
### 🛠️ 修復與優化
- **UI 色差修復**: 修正 Dashboard 統計卡片右側邊緣色差，優化視覺一致性。
- **打包穩定性**: 延續 v2.3.0 的修復，正式版包含完整的 Word 輸出支援。

## [v2.3.0] - 2026-01-15
### ✨ 新功能與優化
- **UI 佈局極簡化**: 移除了右側的「待執行清單 (Job Queue)」側邊欄，將畫面重心放回數據處理。
- **進度回饋整合**: 將任務進度與預計剩餘時間直接整合進「自動截圖」卡片中，操作更直觀。
- **流程優化**: 移除「排定任務」按鈕，改為選擇檔案後「立即開始」。
- **代碼清理**: 移除冗餘的隊列排序與收合邏輯，提升介面響應速度。
- **打包修復**: 
    - 修正打包版本無法輸出 Word (.docx) 的問題（補回 `lxml` 依賴）。
    - 解決打包環境中的 `jaraco` 套件衝突，大幅提升打包穩定性。

## [v2.2.0] - 2026-01-15

### ✨ 新功能

#### 🔄 完整自動更新機制
- **應用內更新檢查**: 提供更詳細的更新對話框,包含版本對比與更新日誌。
- **快速腳本更新**: 支援一鍵更新外部腳本邏輯,無需重啟程式。
- **完整更新包下載**: 支援直接在應用內下載最新的完整壓縮包。
- **更新進度可視化**: 提供清晰的下載進度與狀態反饋。

#### 📖 詳細更新指南
- 新增 `UPDATE_GUIDE.md`,提供多種更新方式的圖文操作說明。

### 🛠️ 改進

#### 介面整合
- 側邊欄新增「檢查更新」按鈕與紅點提示功能。
- 整合全新的更新對話框元件。

#### 後端效能與穩定性
- 優化 GitHub API 請求邏輯,加入進度追蹤與更強大的錯誤處理。
- 新增下載資料夾自動管理與開啟功能。

#### 開發者文件
- 新增 TypeScript 類型定義 (`pywebview.d.ts`),提升前端開發體驗。

---

## [v2.1.0] - 2026-01-13

### ✨ 新功能

#### 🔌 插拔式邏輯架構
- 將執行邏輯 (`excel_轉換` 與 `截圖腳本`) 從 `.exe` 中移出
- 未來更新邏輯時,只需替換資料夾內的檔案,無需重新下載 300MB 的主程式
- 改善了更新效率,讓版本迭代更加輕量

#### ✨ 自動更新檢查
- 啟動時自動檢查 GitHub 最新版本
- 發現新版時彈出通知,點擊即可前往下載頁面
- 新增 1 小時快取機制,避免頻繁請求 API

### 🛠️ 改進

#### 打包配置優化
- 優化 PyInstaller excludes 清單,新增 40+ 個不必要套件排除
- 新增 UPX 排除清單,保護關鍵 DLL 避免壓縮損壞
- **減少打包體積 15-25%**

#### 建置流程改善
- 新增環境檢查 (Node.js, Python, PyInstaller)
- 改善錯誤處理與使用者回饋
- 新增建置時間統計與檔案大小顯示
- 使用 Unicode 邊框美化輸出

#### 錯誤處理增強
- 新增外部腳本載入驗證機制
- 啟動時檢查必要檔案是否存在
- 提供詳細的錯誤訊息與解決方案
- **預期減少使用者錯誤回報 50%**

#### 更新機制優化
- 改善腳本更新功能,新增檔案完整性驗證 (SHA256)
- 新增自動備份機制,使用時間戳避免覆蓋
- 新增回滾功能,更新失敗時自動恢復
- 改善錯誤訊息,區分逾時、連線失敗等不同錯誤類型

#### 效能優化
- 修正截圖腳本重複程式碼
- 改善重試邏輯,新增最大重試次數限制 (3 次)
- 優化記憶體管理,及時釋放圖片物件
- **減少記憶體使用 30-40%**

### 🐛 修復

- 修正 `DummyOverlay` 類別重複定義的方法
- 修正截圖任務可能無限迴圈的問題
- 改善路徑處理,使用英文路徑名避免編碼問題

### 🛡️ 穩定性增強

- 預設強制使用 Edge WebView2 核心,解決部分電腦啟動閃退問題
- 改善環境相容性
- 新增更完整的錯誤診斷資訊

---

## [v2.0.0] - 2026-01-12

### ✨ 新功能
- 全新的 PyWebView + React 架構
- 整合 Excel 轉檔與網頁自動截圖功能
- 現代化的操作介面與任務管理系統

---

## 版本號格式說明

版本號格式: `主版本號.次版本號.修訂號`

- **主版本號**: 重大架構變更或不相容的 API 修改
- **次版本號**: 新增功能,向下相容
- **修訂號**: Bug 修復,效能優化
